!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("assert"),require("saga-slice"),require("axios"),require("redux-saga")):"function"==typeof define&&define.amd?define(["exports","assert","saga-slice","axios","redux-saga"],t):t((e=e||self).SagaSliceTool={},e.assert,e.sagaSlice,e.axios,e.reduxSaga)}(this,(function(e,t,n,r,a){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t=t&&t.hasOwnProperty("default")?t.default:t;var i=function(e){return"@@redux-saga/"+e},s=i("CANCEL_PROMISE"),d=i("IO"),f=i("MULTICAST"),l=function(e){return null==e},p=function(e){return null!=e},g=function(e){return"function"==typeof e},v=function(e){return"string"==typeof e},h=Array.isArray,m=function e(t){return t&&(v(t)||S(t)||g(t)||h(t)&&t.every(e))},b=function(e){return e&&g(e.take)&&g(e.close)},y=function(e){return g(e)&&e.hasOwnProperty("toString")},S=function(e){return!!e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype},x=function(e){return b(e)&&e[f]};function O(e,t){var n;void 0===t&&(t=!0);var r=new Promise((function(r){n=setTimeout(r,e,t)}));return r[s]=function(){clearTimeout(n)},r}var w=function(e){return e};function A(e,t,n){if(!t(e))throw Error(n)}var k=function(e){throw e},R=function(e){return{value:e,done:!0}};var j="TAKE",q="PUT",F="RACE",C="CALL",D="FORK",L="SELECT",P=function(e,t){var n;return(n={})[d]=!0,n.combinator=!1,n.type=e,n.payload=t,n};function E(e,t){if(void 0===e&&(e="*"),arguments.length&&A(arguments[0],p,"take(patternOrChannel): patternOrChannel is undefined"),m(e))return P(j,{pattern:e});if(x(e)&&p(t)&&m(t))return P(j,{channel:e,pattern:t});if(b(e))return P(j,{channel:e});throw Error("take(patternOrChannel): argument "+e+" is not valid channel or a valid pattern")}function T(e,t){return arguments.length>1?(A(e,p,"put(channel, action): argument channel is undefined"),A(e,b,"put(channel, action): argument "+e+" is not a valid channel"),A(t,p,"put(channel, action): argument action is undefined")):A(e,p,"put(action): argument action is undefined"),l(t)&&(t=e,e=void 0),P(q,{channel:e,action:t})}var U=function(e,t){if(A(t,p,e+": argument fn is undefined or null"),!g(t)){var n,r,a=null;if(h(t))a=t[0],A(n=t[1],p,e+": argument of type [context, fn] has undefined or null `fn`");else{if(!(r=t)||h(r)||"object"!=typeof r)return void A(t,g,e+": argument fn is not function");a=t.context,A(n=t.fn,p,e+": argument of type {context, fn} has undefined or null `fn`")}a&&v(n)?A(a[n],g,e+': context arguments has no such method - "'+n+'"'):A(n,g,e+": unpacked fn argument (from [context, fn] or {context, fn}) is not a function")}};function I(e,t){var n,r=null;return g(e)?n=e:(h(e)?(r=e[0],n=e[1]):(r=e.context,n=e.fn),r&&v(n)&&g(r[n])&&(n=r[n])),{context:r,fn:n,args:t}}var z=function(e){return e!==H};function M(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];var a="number"==typeof n[0]?n[0]:"ms";return A(e,z,"instead of writing `yield call(delay, "+a+")` where delay is an effect from `redux-saga/effects` you should write `yield delay("+a+")`"),U("call",e),P(C,I(e,n))}function N(e){U("fork",e);for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return P(D,I(e,n))}function _(e){void 0===e&&(e=w);for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return arguments.length&&(A(arguments[0],p,"select(selector, [...]): argument selector is undefined"),A(e,g,"select(selector, [...]): argument "+e+" is not a function")),P(L,{selector:e,args:n})}var H=M.bind(null,O),K=function(e){return{done:!0,value:e}},B={};function G(e,t,n){var r,a,o,c=t;function u(t,n){if(c===B)return K(t);if(n&&!a)throw c=B,n;r&&r(t);var u=n?e[a](n):e[c]();return o=u.effect,r=u.stateUpdater,a=u.errorState,(c=u.nextState)===B?K(t):o}return function(e,t,n){void 0===t&&(t=k),void 0===n&&(n="iterator");var r={meta:{name:n},next:e,throw:t,return:R,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}(u,(function(e){return u(null,e)}),n)}function J(e,t,n){for(var r=arguments.length,a=Array(r>3?r-3:0),o=3;r>o;o++)a[o-3]=arguments[o];var c,u,i,s,d={done:!1,value:E(t)},f={done:!1,value:(i={action:E(t),debounce:H(e)},s=P(F,i),s.combinator=!0,s)},l=function(e){return c=e},p=function(e){return u=e};return G({q1:function(){return{nextState:"q2",effect:d,stateUpdater:l}},q2:function(){return{nextState:"q3",effect:f,stateUpdater:p}},q3:function(){return u.debounce?{nextState:"q1",effect:(t=c,{done:!1,value:N.apply(void 0,[n].concat(a,[t]))})}:{nextState:"q2",effect:(e=u.action,{done:!1,value:e}),stateUpdater:l};var e,t}},"q1","debounce("+function(e){return b(e)?"channel":y(e)?e+"":g(e)?e.name:e+""}(t)+", "+n.name+")")}function Q(e,t,n){for(var r=arguments.length,a=Array(r>3?r-3:0),o=3;r>o;o++)a[o-3]=arguments[o];return N.apply(void 0,[J,e,t,n].concat(a))}var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=e.name,a=e.sagaApi;return t(!!r&&r.constructor===String,"options.name: the resource's REST name is required"),t(!!a&&a.constructor===Object,"options.sagaApi: API object is required"),function(e){var t;return u((o(t={},e.readAll,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.get("/".concat(r),e.readAllSuccess,e.readAllFail,e.readAllDone);case 2:case"end":return t.stop()}}),t)}))),o(t,e.readOne,regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.payload,t.next=3,a.get("/".concat(r,"/").concat(o),e.readOneSuccess,e.readOneFail,e.readOneDone);case 3:case"end":return t.stop()}}),t)}))),o(t,e.create,regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.payload,t.next=3,a.post("/".concat(r),o,e.createSuccess,e.createFail,e.createDone);case 3:case"end":return t.stop()}}),t)}))),o(t,e.update,regeneratorRuntime.mark((function t(n){var o,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=(o=n.payload).id,u=o.changeset,t.next=4,a.put("/".concat(r,"/").concat(c),u,e.updateSuccess,e.updateFail,e.updateDone);case 4:case"end":return t.stop()}}),t)}))),o(t,e.patch,regeneratorRuntime.mark((function t(n){var o,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=(o=n.payload).id,u=o.changeset,t.next=4,a.patch("/".concat(r,"/").concat(c),u,e.patchSuccess,e.patchFail,e.patchDone);case 4:case"end":return t.stop()}}),t)}))),o(t,e.delete,regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.payload,t.next=3,a.delete("/".concat(r,"/").concat(o),null,e.deleteSuccess,e.deleteFail,e.deleteDone);case 3:case"end":return t.stop()}}),t)}))),t),n?n(e):{})}},W=function(e,t){e.isLoading=!1,e.data=Object.values(t||{}).reduce((function(e,t){return u({},e,o({},t.id,t))}),{})},X=function(e,t){e.isLoading=!1,e.data[t.id]=u({},e.data[t.id]||{},{},t)},Y=function(e,t){e.isLoading=!1,e.data[t.id]=t},Z=function(e,t){e.isLoading=!1,e.data[t.id]=u({},e.data[t.id]||{},{},t)},$=function(e,t){e.isLoading=!1,delete e.data[t.id]},ee=function(e,t){e.isLoading=!1,e.error=t},te=function(e){e.isLoading=!0},ne=function(e){e.isLoading=!1},re=function(e,t){t.constructor===Object&&(e.current=t),t.constructor!==Number&&t.constructor!==String||(e.current=e.data[t])},ae=function(e){e.current=null},oe=function(){},ce=function(e){return u({isLoading:!1,current:null,data:{},error:null},e||{})},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return u({readAllSuccess:W,readOneSuccess:X,createSuccess:Y,updateSuccess:Z,patchSuccess:Z,deleteSuccess:$,setCurrent:re,resetCurrent:ae,readAll:te,readOne:te,create:te,update:te,patch:te,delete:te,readAllFail:ee,readOneFail:ee,createFail:ee,updateFail:ee,patchFail:ee,deleteFail:ee},t?{readAllDone:oe,readOneDone:oe,createDone:oe,updateDone:oe,patchDone:oe,deleteDone:oe}:{},{},e)},ie=function(e,t,n){for(var o=r.CancelToken.source(),c=[n],i=arguments.length,s=Array(i>3?i-3:0),d=3;i>d;d++)s[d-3]=arguments[d];"get"!==t&&c.push(s.shift());var f=s.shift()||{};c.push(u({},f,{cancelToken:o.token}));var l=e[t].apply(e,c);return l.cancel=function(){return o.cancel("request was cancelled by user")},l[a.CANCEL]=function(){return o.cancel("request was cancelled by sagas")},l},se=regeneratorRuntime.mark(fe),de=function(e){return!!e&&e.constructor===Function&&e.call.constructor===Function};function fe(e,n,r){var a,o,c,u,i,s,d,f,l,p,g=arguments;return regeneratorRuntime.wrap((function(v){for(;;)switch(v.prev=v.next){case 0:for(t(n.constructor===String,"valid method required"),t(!!r&&r.constructor===String,"valid path required"),a=[e[n],r],c=Array((o=g.length)>3?o-3:0),u=3;o>u;u++)c[u-3]=g[u];return"get"!==n&&a.push(c.shift()),i=c.shift(),s=c.shift(),d=c.shift(),t(!!i&&de(i),"success must be a function"),t(!!s&&de(s),"fail must be a function"),t(!d||de(d),"done must be a function"),v.prev=11,v.next=14,M.apply(void 0,a);case 14:return l=v.sent.data,v.next=18,T(i(l));case 18:f={data:l},v.next=30;break;case 21:return v.prev=21,v.t0=v.catch(11),v.next=25,T(s(v.t0));case 25:if(!v.t0.response){v.next=29;break}return p=v.t0.response.status,v.next=29,T({type:"sagaApi/".concat(p),payload:v.t0.response});case 29:f={error:v.t0};case 30:if(!d){v.next=33;break}return v.next=33,T(d(f));case 33:case"end":return v.stop()}}),se,null,[[11,21]])}e.createApis=function(e){var t,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e,n=t.headers,a=void 0===n?{}:n;delete e.headers;var o=a.common||{};e=u({baseURL:window.location.hostname,timeout:5e3},e,{headers:u({},a,{common:u({"Content-Type":"application/json"},o)})});var c=r.create(e),i=function(e,t){c.defaults.headers.common[e]=t},s=function(e){delete c.defaults.headers.common[e]},d=function(e){i("Authorization",e)},f=function(){s("Authorization")};return{get:ie.bind(ie,c,"get"),put:ie.bind(ie,c,"put"),patch:ie.bind(ie,c,"patch"),post:ie.bind(ie,c,"post"),delete:ie.bind(ie,c,"delete"),addAuthorization:d,removeAuthorization:f,addHeader:i,removeHeader:s,instance:c}}(e);return{api:n,sagaApi:(t=n,{get:fe.bind(fe,t,"get"),post:fe.bind(fe,t,"post"),put:fe.bind(fe,t,"put"),patch:fe.bind(fe,t,"patch"),delete:fe.bind(fe,t,"delete")})}},e.createSuccess=Y,e.crudInitialState=ce,e.crudReducers=ue,e.crudSaga=V,e.crudSlice=function(e){var r=e.name,a=e.initialState,o=e.reducers,c=e.sagas,u=e.sagaApi,i=e.takers;return t(!!r&&r.constructor===String,"must provide a valid name"),t(!!u&&u.constructor===Object,"must provide a valid sagaApi"),t(!o||o&&o.constructor===Object,"reducers must be an object"),t(!a||a&&a.constructor===Object,"initialState must be an object"),t(!c||c&&c.constructor===Function,"sagas must be a function"),t(!i||i&&[Object,String].includes(i.constructor),'takers must be an object or "takeEvery"'),n.createModule({name:r,initialState:ce(a||{}),reducers:ue(o||{}),sagas:V({name:r,sagaApi:u,takers:i},c)})},e.deleteSuccess=$,e.failReducer=ee,e.lifecycleReducers=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(o(t={},e,n.main||te),o(t,"".concat(e,"Success"),n.success||ne),o(t,"".concat(e,"Fail"),n.fail||ee),t);return n.done&&(r["".concat(e,"Done")]=n.done instanceof Function?n.done:oe),r},e.loadingReducer=te,e.noop=oe,e.notLoadingReducer=ne,e.readAllSuccess=W,e.readOneSuccess=X,e.refetch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return{saga:regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_((function(e){return e[t].current}));case 2:if(r=n.sent.id){n.next=10;break}return console.warn("no current item set in ".concat(t," state")),void(n.next=8);case 8:n.next=12;break;case 10:return n.next=12,T(e.readOne({payload:r}));case 12:case"end":return n.stop()}}),n)})),taker:Q.bind(Q,n)}},e.resetCurrent=ae,e.setCurrent=re,e.updateSuccess=Z,Object.defineProperty(e,"__esModule",{value:!0})}));
